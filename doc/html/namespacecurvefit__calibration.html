<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>curvefit: curvefit_calibration Module Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">curvefit
   &#160;<span id="projectnumber">1.2.0</span>
   </div>
   <div id="projectbrief">A library for fitting functions to sets of data.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="namespaces.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Types&#160;List</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="namespaces.html"><span>Modules&#160;List</span></a></li>
      <li><a href="namespacemembers.html"><span>Module&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('namespacecurvefit__calibration.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Types</a> &#124;
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle">
<div class="title">curvefit_calibration Module Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><b><a class="el" href="namespacecurvefit__calibration.html" title="curvefit_calibration ">curvefit_calibration</a></b>  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Types</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">interface &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="interfacecurvefit__calibration_1_1crosstalk.html">crosstalk</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes the crosstalk errors for a multiple degree-of-freedom data set.  <a href="interfacecurvefit__calibration_1_1crosstalk.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">interface &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="interfacecurvefit__calibration_1_1hysteresis.html">hysteresis</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes the hysteresis in an ascending/descending data set.  <a href="interfacecurvefit__calibration_1_1hysteresis.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">interface &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="interfacecurvefit__calibration_1_1_i_d_a_m_a_x.html">IDAMAX</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">interface &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="interfacecurvefit__calibration_1_1nonlinearity.html">nonlinearity</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes the best-fit nonlinearity of a data set.  <a href="interfacecurvefit__calibration_1_1nonlinearity.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">interface &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="interfacecurvefit__calibration_1_1repeatability.html">repeatability</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes the repeatability of a sequence of tests.  <a href="interfacecurvefit__calibration_1_1repeatability.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">interface &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="interfacecurvefit__calibration_1_1return__to__zero.html">return_to_zero</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes the return to zero error in an ascending/descending data set.  <a href="interfacecurvefit__calibration_1_1return__to__zero.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">interface &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="interfacecurvefit__calibration_1_1seb.html">seb</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes the static error band of a data set.  <a href="interfacecurvefit__calibration_1_1seb.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">type &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structcurvefit__calibration_1_1seb__results.html">seb_results</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Defines a container for static error band related information.  <a href="structcurvefit__calibration_1_1seb__results.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">interface &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="interfacecurvefit__calibration_1_1split__ascend__descend.html">split_ascend_descend</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Splits a data set into ascending and descending components.  <a href="interfacecurvefit__calibration_1_1split__ascend__descend.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">interface &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="interfacecurvefit__calibration_1_1terminal__nonlinearity.html">terminal_nonlinearity</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes the terminal nonlinearity of a data set.  <a href="interfacecurvefit__calibration_1_1terminal__nonlinearity.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a65e7eb0c62988aeea58c9d3af3033640"><td class="memItemLeft" align="right" valign="top">type(<a class="el" href="structcurvefit__calibration_1_1seb__results.html">seb_results</a>) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecurvefit__calibration.html#a65e7eb0c62988aeea58c9d3af3033640">seb_1</a> (applied, output, fullscale, err)</td></tr>
<tr class="memdesc:a65e7eb0c62988aeea58c9d3af3033640"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes the static error band of a data set.  <a href="#a65e7eb0c62988aeea58c9d3af3033640">More...</a><br /></td></tr>
<tr class="separator:a65e7eb0c62988aeea58c9d3af3033640"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a89ea5f78c45c018eb6ea44148e4f7d78"><td class="memItemLeft" align="right" valign="top">real(real64) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecurvefit__calibration.html#a89ea5f78c45c018eb6ea44148e4f7d78">bf_nonlin</a> (applied, measured, err)</td></tr>
<tr class="memdesc:a89ea5f78c45c018eb6ea44148e4f7d78"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes the best-fit nonlinearity of a data set.  <a href="#a89ea5f78c45c018eb6ea44148e4f7d78">More...</a><br /></td></tr>
<tr class="separator:a89ea5f78c45c018eb6ea44148e4f7d78"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0164b144200a32702a84d3a3a41eadac"><td class="memItemLeft" align="right" valign="top">real(real64) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecurvefit__calibration.html#a0164b144200a32702a84d3a3a41eadac">term_nonlin</a> (applied, measured, err)</td></tr>
<tr class="memdesc:a0164b144200a32702a84d3a3a41eadac"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes the terminal nonlinearity of a data set.  <a href="#a0164b144200a32702a84d3a3a41eadac">More...</a><br /></td></tr>
<tr class="separator:a0164b144200a32702a84d3a3a41eadac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae8c6c141a009961229624cf9ecc0aa32"><td class="memItemLeft" align="right" valign="top">real(real64) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecurvefit__calibration.html#ae8c6c141a009961229624cf9ecc0aa32">hysteresis_1</a> (xascend, ascend, xdescend, descend, err)</td></tr>
<tr class="memdesc:ae8c6c141a009961229624cf9ecc0aa32"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes the hysteresis in an ascending/descending data set.  <a href="#ae8c6c141a009961229624cf9ecc0aa32">More...</a><br /></td></tr>
<tr class="separator:ae8c6c141a009961229624cf9ecc0aa32"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a87cc3906fa05b6bb1c06cdea9f84c759"><td class="memItemLeft" align="right" valign="top">real(real64) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecurvefit__calibration.html#a87cc3906fa05b6bb1c06cdea9f84c759">hysteresis_2</a> (applied, measured, err)</td></tr>
<tr class="memdesc:a87cc3906fa05b6bb1c06cdea9f84c759"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes the hysteresis in an ascending/descending data set.  <a href="#a87cc3906fa05b6bb1c06cdea9f84c759">More...</a><br /></td></tr>
<tr class="separator:a87cc3906fa05b6bb1c06cdea9f84c759"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a62985c9db1f236166fa8c5b525433e05"><td class="memItemLeft" align="right" valign="top">real(real64) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecurvefit__calibration.html#a62985c9db1f236166fa8c5b525433e05">rtz_1</a> (applied, measured, tol, err)</td></tr>
<tr class="memdesc:a62985c9db1f236166fa8c5b525433e05"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes the return to zero error in an ascending/descending data set.  <a href="#a62985c9db1f236166fa8c5b525433e05">More...</a><br /></td></tr>
<tr class="separator:a62985c9db1f236166fa8c5b525433e05"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7fe392e91d3d65dc130bf216f6aa4965"><td class="memItemLeft" align="right" valign="top">real(real64) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecurvefit__calibration.html#a7fe392e91d3d65dc130bf216f6aa4965">repeat_1</a> (applied, measured, err)</td></tr>
<tr class="memdesc:a7fe392e91d3d65dc130bf216f6aa4965"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes the repeatability of a sequence of tests.  <a href="#a7fe392e91d3d65dc130bf216f6aa4965">More...</a><br /></td></tr>
<tr class="separator:a7fe392e91d3d65dc130bf216f6aa4965"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8ae5a100d1d0fc349ded7c7d4e8651cb"><td class="memItemLeft" align="right" valign="top">real(real64) function, dimension(size(xerr, 2), size(xerr, 2))&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecurvefit__calibration.html#a8ae5a100d1d0fc349ded7c7d4e8651cb">xtalk_1</a> (xerr, indices, err)</td></tr>
<tr class="memdesc:a8ae5a100d1d0fc349ded7c7d4e8651cb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes the crosstalk errors for a multiple degree-of-freedom data set.  <a href="#a8ae5a100d1d0fc349ded7c7d4e8651cb">More...</a><br /></td></tr>
<tr class="separator:a8ae5a100d1d0fc349ded7c7d4e8651cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2a2db82263c78d8ddbf67c437ff68a4f"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecurvefit__calibration.html#a2a2db82263c78d8ddbf67c437ff68a4f">split_ascend_descend_1</a> (x, ascend, descend, nascend, ndescend,                           err)</td></tr>
<tr class="memdesc:a2a2db82263c78d8ddbf67c437ff68a4f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Splits a data set into ascending and descending components.  <a href="#a2a2db82263c78d8ddbf67c437ff68a4f">More...</a><br /></td></tr>
<tr class="separator:a2a2db82263c78d8ddbf67c437ff68a4f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p><b><a class="el" href="namespacecurvefit__calibration.html" title="curvefit_calibration ">curvefit_calibration</a></b> </p>
<dl class="section user"><dt>Purpose</dt><dd>To provide routines for computing calibration performance metrics commonly used to assess the fitness of a calibration curve fit.</dd></dl>
<dl class="section user"><dt>References</dt><dd><ul>
<li>Wheeler, Anthony J., Ganji, Ahmad R., "Introduction to Engineering
      Experimentation," Third Edition, Prentice Hall.</li>
</ul>
</dd></dl>
<dl class="section user"><dt>Example</dt><dd>The following example illustrates the use of a selection of the routines in this module. <div class="fragment"><div class="line"><span class="keyword">program</span> example</div><div class="line">    <span class="keywordtype">use </span>iso_fortran_env</div><div class="line">    <span class="keywordtype">use </span><a class="code" href="namespacecurvefit__calibration.html">curvefit_calibration</a></div><div class="line">    <span class="keywordtype">use </span><a class="code" href="namespacecurvefit__regression.html">curvefit_regression</a><span class="keywordtype">, only</span> : <a class="code" href="interfacecurvefit__regression_1_1linear__least__squares.html">linear_least_squares</a></div><div class="line">    <span class="keywordtype">implicit none</span></div><div class="line"></div><div class="line">    <span class="comment">! Local Variables</span></div><div class="line">    <span class="keywordtype">real(real64)</span>, <span class="keywordtype">parameter</span> :: fullscale = 5.0d2</div><div class="line">    <span class="keywordtype">real(real64)</span>, <span class="keywordtype">dimension(11)</span> :: applied, output, measured, applied_copy</div><div class="line">    <span class="keywordtype">real(real64)</span> :: hyst, gain, nlin</div><div class="line">    <span class="keywordtype">type</span>(<a class="code" href="structcurvefit__calibration_1_1seb__results.html">seb_results</a>) :: s</div><div class="line"></div><div class="line">    <span class="comment">! Initialization</span></div><div class="line">    applied = [0.0d0, 1.0d2, 2.0d2, 3.0d2, 4.0d2, 5.0d2, 4.0d2, 3.0d2, &amp;</div><div class="line">      2.0d2, 1.0d2, 0.0d0]</div><div class="line">    output = [0.0d0, 0.55983d0, 1.11975d0, 1.67982d0, 2.24005d0, &amp;</div><div class="line">      2.80039d0, 2.24023d0, 1.68021d0, 1.12026d0, 0.56021d0, 0.00006d0]</div><div class="line">    applied_copy = applied</div><div class="line"></div><div class="line">    <span class="comment">! Determine a suitable calibration gain (the least squares routine modifies</span></div><div class="line">    <span class="comment">! applied; hence, the need for the copy)</span></div><div class="line">    gain = <a class="code" href="interfacecurvefit__regression_1_1linear__least__squares.html">linear_least_squares</a>(output, applied_copy)</div><div class="line"></div><div class="line">    <span class="comment">! Apply the calibration gain</span></div><div class="line">    measured = gain * output</div><div class="line"></div><div class="line">    <span class="comment">! Compute the SEB</span></div><div class="line">    s = <a class="code" href="interfacecurvefit__calibration_1_1seb.html">seb</a>(applied, output, fullscale)</div><div class="line"></div><div class="line">    <span class="comment">! Compute the best fit nonlinearity</span></div><div class="line">    nlin = <a class="code" href="interfacecurvefit__calibration_1_1nonlinearity.html">nonlinearity</a>(applied, measured)</div><div class="line"></div><div class="line">    <span class="comment">! Compute the hysteresis</span></div><div class="line">    hyst = <a class="code" href="interfacecurvefit__calibration_1_1hysteresis.html">hysteresis</a>(applied, measured)</div><div class="line"></div><div class="line">    <span class="comment">! Display the results</span></div><div class="line">    print <span class="stringliteral">&#39;(AF9.5)&#39;</span>, <span class="stringliteral">&quot;Calibration Gain: &quot;</span>, gain</div><div class="line">    print <span class="stringliteral">&#39;(AF6.4)&#39;</span>, <span class="stringliteral">&quot;SEB: &quot;</span>, s%seb</div><div class="line">    print <span class="stringliteral">&#39;(AF7.5)&#39;</span>, <span class="stringliteral">&quot;SEB Output: &quot;</span>, s%output</div><div class="line">    print <span class="stringliteral">&#39;(AF7.4)&#39;</span>, <span class="stringliteral">&quot;Best Fit Nonlinearity: &quot;</span>, nlin</div><div class="line">    print <span class="stringliteral">&#39;(AF6.4)&#39;</span>, <span class="stringliteral">&quot;Hysteresis: &quot;</span>, hyst</div><div class="line"><span class="keyword">end program</span></div></div><!-- fragment --> The above program produces the following output. <div class="fragment"><div class="line">Calibration Gain: 178.55935</div><div class="line">SEB: 0.0518</div><div class="line">SEB Output: 2.80010</div><div class="line">Best Fit Nonlinearity: -0.0582</div><div class="line">Hysteresis: 0.0911</div></div><!-- fragment --> </dd></dl>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a class="anchor" id="a89ea5f78c45c018eb6ea44148e4f7d78"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real(real64) function curvefit_calibration::bf_nonlin </td>
          <td>(</td>
          <td class="paramtype">real(real64), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>applied</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>measured</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">class(errors), intent(inout), optional, target&#160;</td>
          <td class="paramname"><em>err</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Computes the best-fit nonlinearity of a data set. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">applied</td><td>An N-element array containing the values applied to the measurement instrument. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">measured</td><td>An N-element array containing the calibrated output of the instrument as a result of the values given in <code>applied</code>. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">err</td><td>An optional errors-based object that if provided can be used to retrieve information relating to any errors encountered during execution. If not provided, a default implementation of the errors class is used internally to provide error handling. Possible errors and warning messages that may be encountered are as follows.<ul>
<li>CF_ARRAY_SIZE_ERROR: Occurs if <code>applied</code> and <code>measured</code> are not the same size.</li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The nonlinearity error. </dd></dl>

<p>Definition at line <a class="el" href="curvefit__calibration_8f90_source.html#l00268">268</a> of file <a class="el" href="curvefit__calibration_8f90_source.html">curvefit_calibration.f90</a>.</p>

</div>
</div>
<a class="anchor" id="ae8c6c141a009961229624cf9ecc0aa32"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real(real64) function curvefit_calibration::hysteresis_1 </td>
          <td>(</td>
          <td class="paramtype">real(real64), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>xascend</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>ascend</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>xdescend</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>descend</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">class(errors), intent(inout), optional, target&#160;</td>
          <td class="paramname"><em>err</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Computes the hysteresis in an ascending/descending data set. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">xascend</td><td>An N-element array containing the ascending calibration points. This array must be monotonically increasing or decreasing. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ascend</td><td>An N-element array containing the sensor output to the calibration points in <code>xascend</code>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">xdescend</td><td>An M-element array containing the descending calibration points. This array must be monotonically increasing or decreasing. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">descend</td><td>An M-element array containing the sensor output to the calibration points in <code>xdescend</code>. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">err</td><td>An optional errors-based object that if provided can be used to retrieve information relating to any errors encountered during execution. If not provided, a default implementation of the errors class is used internally to provide error handling. Possible errors and warning messages that may be encountered are as follows.<ul>
<li>CF_ARRAY_SIZE_ERROR: Occurs if <code>xascend</code> and <code>ascend</code> are not the same size, or if <code>xdescend</code> and <code>descend</code> are not the same size.</li>
<li>CF_NONMONOTONIC_ARRAY_ERROR: Occurs if the calibration data is not monotonic in nature (either ascending or descending).</li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The hysteresis error.</dd></dl>
<dl class="section user"><dt>Remarks</dt><dd>In order to account for slight variations between similar ascending and descending points, the algorithm used performs a linear interpolation between data points. The resulting interpolated value is then used to compute the reported hysteresis error. </dd></dl>

<p>Definition at line <a class="el" href="curvefit__calibration_8f90_source.html#l00410">410</a> of file <a class="el" href="curvefit__calibration_8f90_source.html">curvefit_calibration.f90</a>.</p>

</div>
</div>
<a class="anchor" id="a87cc3906fa05b6bb1c06cdea9f84c759"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real(real64) function curvefit_calibration::hysteresis_2 </td>
          <td>(</td>
          <td class="paramtype">real(real64), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>applied</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>measured</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">class(errors), intent(inout), optional, target&#160;</td>
          <td class="paramname"><em>err</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Computes the hysteresis in an ascending/descending data set. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">applied</td><td>An N-element array containing the values applied to the measurement instrument. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">measured</td><td>An N-element array containing the calibrated output of the instrument as a result of the values given in <code>applied</code>. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">err</td><td>An optional errors-based object that if provided can be used to retrieve information relating to any errors encountered during execution. If not provided, a default implementation of the errors class is used internally to provide error handling. Possible errors and warning messages that may be encountered are as follows.<ul>
<li>CF_NONMONOTONIC_ARRAY_ERROR: Occurs if the calibration data is not monotonic in nature (either ascending or descending).</li>
<li>CF_ARRAY_SIZE_ERROR: Occurs if <code>applied</code> and <code>measured</code> are not the same size.</li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The hysteresis error.</dd></dl>
<dl class="section user"><dt>Remarks</dt><dd>In order to account for slight variations between similar ascending and descending points, the algorithm used performs a linear interpolation between data points. The resulting interpolated value is then used to compute the reported hysteresis error. </dd></dl>

<p>Definition at line <a class="el" href="curvefit__calibration_8f90_source.html#l00501">501</a> of file <a class="el" href="curvefit__calibration_8f90_source.html">curvefit_calibration.f90</a>.</p>

</div>
</div>
<a class="anchor" id="a7fe392e91d3d65dc130bf216f6aa4965"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real(real64) function curvefit_calibration::repeat_1 </td>
          <td>(</td>
          <td class="paramtype">real(real64), dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>applied</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>measured</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">class(errors), intent(inout), optional, target&#160;</td>
          <td class="paramname"><em>err</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Computes the repeatability of a sequence of tests. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">applied</td><td>An NPTS-by-NTEST matrix containing at least 2 columns (tests) of NPTS values applied to the measurement instrument. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">measured</td><td>An NPTS-by-NTEST matrix containing the corresponding calibrated output from the instrument. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">err</td><td>An optional errors-based object that if provided can be used to retrieve information relating to any errors encountered during execution. If not provided, a default implementation of the errors class is used internally to provide error handling. Possible errors and warning messages that may be encountered are as follows.<ul>
<li>CF_ARRAY_SIZE_ERROR: Occurs if <code>applied</code> and <code>measured</code> are not the same size.</li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The largest magnitude deviation from the initial test.</dd></dl>
<dl class="section user"><dt>Remarks</dt><dd>Repeatability is considered as the largest magnitude deviation of subsequent tests from the initial test. Noting that it is very likely that consecutive test points will vary slightly, test 2 through test N are linearly interpolated such that their test points line up with those from test 1. </dd></dl>

<p>Definition at line <a class="el" href="curvefit__calibration_8f90_source.html#l00665">665</a> of file <a class="el" href="curvefit__calibration_8f90_source.html">curvefit_calibration.f90</a>.</p>

</div>
</div>
<a class="anchor" id="a62985c9db1f236166fa8c5b525433e05"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real(real64) function curvefit_calibration::rtz_1 </td>
          <td>(</td>
          <td class="paramtype">real(real64), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>applied</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>measured</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), intent(in), optional&#160;</td>
          <td class="paramname"><em>tol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">class(errors), intent(inout), optional, target&#160;</td>
          <td class="paramname"><em>err</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Computes the return to zero error in an ascending/descending data set. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">applied</td><td>An N-element array containing the values applied to the measurement instrument. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">measured</td><td>An N-element array containing the calibrated output of the instrument as a result of the values given in <code>applied</code>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tol</td><td>An optional input that specifies the tolerance used in finding the matching data points. If no value is specified, the default value of the square root of machine precision times the largest magnitude value in <code>xcal</code> is used. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">err</td><td>An optional errors-based object that if provided can be used to retrieve information relating to any errors encountered during execution. If not provided, a default implementation of the errors class is used internally to provide error handling. Possible errors and warning messages that may be encountered are as follows.<ul>
<li>CF_ARRAY_SIZE_ERROR: Occurs if <code>applied</code> and <code>measured</code> are not the same size.</li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The return to zero error. </dd></dl>

<p>Definition at line <a class="el" href="curvefit__calibration_8f90_source.html#l00579">579</a> of file <a class="el" href="curvefit__calibration_8f90_source.html">curvefit_calibration.f90</a>.</p>

</div>
</div>
<a class="anchor" id="a65e7eb0c62988aeea58c9d3af3033640"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">type(<a class="el" href="structcurvefit__calibration_1_1seb__results.html">seb_results</a>) function curvefit_calibration::seb_1 </td>
          <td>(</td>
          <td class="paramtype">real(real64), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>applied</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>output</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), intent(in)&#160;</td>
          <td class="paramname"><em>fullscale</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">class(errors), intent(out), optional, target&#160;</td>
          <td class="paramname"><em>err</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Computes the static error band of a data set. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">applied</td><td>An N-element array containing the values applied to the measurement instrument. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">output</td><td>An N-element array containing the values output by the instrument as a result of the values given in <code>applied</code>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fullscale</td><td>The full scale measurement value for the instrument. The units must be consistent with those of <code>applied</code>. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">err</td><td>An optional errors-based object that if provided can be used to retrieve information relating to any errors encountered during execution. If not provided, a default implementation of the errors class is used internally to provide error handling. Possible errors and warning messages that may be encountered are as follows.<ul>
<li>CF_ARRAY_SIZE_ERROR: Occurs if <code>applied</code> and <code>output</code> are not the same size.</li>
<li>CF_INVALID_INPUT_ERROR: Occurs if <code>fullscale</code> is sufficiently close to zero to be considered zero. Sufficiently close in this instance is considered to be the square root of machine precision.</li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The static error band information. </dd></dl>

<p>Definition at line <a class="el" href="curvefit__calibration_8f90_source.html#l00183">183</a> of file <a class="el" href="curvefit__calibration_8f90_source.html">curvefit_calibration.f90</a>.</p>

</div>
</div>
<a class="anchor" id="a2a2db82263c78d8ddbf67c437ff68a4f"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine curvefit_calibration::split_ascend_descend_1 </td>
          <td>(</td>
          <td class="paramtype">real(real64), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), dimension(:), intent(out)&#160;</td>
          <td class="paramname"><em>ascend</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), dimension(:), intent(out)&#160;</td>
          <td class="paramname"><em>descend</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(int32), intent(out)&#160;</td>
          <td class="paramname"><em>nascend</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(int32), intent(out)&#160;</td>
          <td class="paramname"><em>ndescend</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">class(errors), intent(inout), optional, target&#160;</td>
          <td class="paramname"><em>err</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Splits a data set into ascending and descending components. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>An N-element array containing the data set to split. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ascend</td><td>An array where the ascending points will be written. Ensure this array is appropriately sized to accept all the ascending points (it can be oversized). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">descend</td><td>An array where the descending points will be written. Ensure this array is appropriately sized to accept all the descending points (it can be oversized). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">nascend</td><td>The actual number of values written into <code>ascend</code>. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ndescend</td><td>The actual number of values written into <code>descend</code>. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">err</td><td>An optional errors-based object that if provided can be used to retrieve information relating to any errors encountered during execution. If not provided, a default implementation of the errors class is used internally to provide error handling. Possible errors and warning messages that may be encountered are as follows.<ul>
<li>CF_ARRAY_SIZE_ERROR: Occurs if either <code>ascend</code> or <code>descend</code> is too small to actually accept all of the necessary data.</li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Remarks</dt><dd>The routine operates by finding the first occurrence where the data set is no longer monotonic, and then copies everything prior to that value, along with the the inflection value, into the output ascending data array. The routine then searches for either a change in direction, or a value that matches the first value in the ascending data set within some tolerance to determine the bounds on the descending data set. Once the bounds are determined, the descending data set is copied from the original array and placed in the output descending data array. This then means that any remaining data in the original data set that lies after either of the aforementioned sets is ignored.</dd></dl>
<dl class="section user"><dt>Example</dt><dd><pre class="fragment"> Given the following array X,
  X:
   0.0000000000000000
   0.38905000686645508
   0.77815997600555420
   0.97268998622894287
   1.1671400070190430
   1.5559999942779541
   1.9448399543762207
   0.97259998321533203
   -9.9999997473787516E-006

 This routine splits the array into the following ascending and
 descending arrays.

 ASCENDING:
   0.0000000000000000
   0.38905000686645508
   0.77815997600555420
   0.97268998622894287
   1.1671400070190430
   1.5559999942779541
   1.9448399543762207

 DESCENDING:
   1.9448399543762207
   0.97259998321533203
   -9.9999997473787516E-006</pre> </dd></dl>

<p>Definition at line <a class="el" href="curvefit__calibration_8f90_source.html#l01068">1068</a> of file <a class="el" href="curvefit__calibration_8f90_source.html">curvefit_calibration.f90</a>.</p>

</div>
</div>
<a class="anchor" id="a0164b144200a32702a84d3a3a41eadac"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real(real64) function curvefit_calibration::term_nonlin </td>
          <td>(</td>
          <td class="paramtype">real(real64), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>applied</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>measured</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">class(errors), intent(inout), optional, target&#160;</td>
          <td class="paramname"><em>err</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Computes the terminal nonlinearity of a data set. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">applied</td><td>An N-element array containing the values applied to the measurement instrument. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">measured</td><td>An N-element array containing the calibrated output of the instrument as a result of the values given in <code>applied</code>. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">err</td><td>An optional errors-based object that if provided can be used to retrieve information relating to any errors encountered during execution. If not provided, a default implementation of the errors class is used internally to provide error handling. Possible errors and warning messages that may be encountered are as follows.<ul>
<li>CF_ARRAY_SIZE_ERROR: Occurs if <code>applied</code> and <code>measured</code> are not the same size.</li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The terminal nonlinearity error. </dd></dl>

<p>Definition at line <a class="el" href="curvefit__calibration_8f90_source.html#l00324">324</a> of file <a class="el" href="curvefit__calibration_8f90_source.html">curvefit_calibration.f90</a>.</p>

</div>
</div>
<a class="anchor" id="a8ae5a100d1d0fc349ded7c7d4e8651cb"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real(real64) function, dimension(size(xerr, 2), size(xerr, 2)) curvefit_calibration::xtalk_1 </td>
          <td>(</td>
          <td class="paramtype">real(real64), dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>xerr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(int32), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>indices</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">class(errors), intent(inout), optional, target&#160;</td>
          <td class="paramname"><em>err</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Computes the crosstalk errors for a multiple degree-of-freedom data set. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">xerr</td><td>An NPTS-by-NDOF matrix containing the measurement error values (computed such that XERR = X MEASURED - X APPLIED). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">indices</td><td>A 2*NDOF element array containing row indices defining the rows where each degree-of-freedom was applied in the data set <code>xerr</code>. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">err</td><td>An optional errors-based object that if provided can be used to retrieve information relating to any errors encountered during execution. If not provided, a default implementation of the errors class is used internally to provide error handling. Possible errors and warning messages that may be encountered are as follows.<ul>
<li>CF_ARRAY_SIZE_ERROR: Occurs if <code>indices</code> is not 2*NDOF in size.</li>
<li>CF_ARRAY_INDEX_ERROR: Occurs if any of the entries in <code>indices</code> are outside the row bounds of <code>xerr</code>.</li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A NDOF-by-NDOF matrix containing the crosstalk errors such that each loaded degree of freedom is represented by its own row, and each responding degree of freedom is represented by its own column.</dd></dl>
<dl class="section user"><dt>Usage</dt><dd>The following program computes the crosstalk errors for a 2 DOF system. The applied data is as follows (there are 34 data points for each DOF). <pre class="fragment"> 0              0
 3000           0
 6000           0
 7500           0
 9000           0
 12000          0
 15000          0
 7500           0
 0              0
 0              0
 -3000          0
 -6000          0
 -7500          0
 -9000          0
 -12000         0
 -15000         0
 -7500          0
 0              0
 --------------------
 0              0
 0              67.79087067
 0              135.5817413
 0              203.3726196
 0              271.1634827
 0              338.9543762
 0              203.3726196
 0              0
 0              0
 0              -67.79087067
 0              -135.5817413
 0              -203.3726196
 0              -271.1634827
 0              -338.9543762
 0              -203.3726196
 0              0</pre> The data output from the instrument under test is as follows. <pre class="fragment"> 0                  0
 0.389050007        1.22E-03
 0.778159976        2.59E-03
 0.972689986        2.90E-03
 1.167140007        3.14E-03
 1.555999994        3.38E-03
 1.944839954        3.56E-03
 0.972599983        4.77E-03
 -1E-05             -1.00E-05
 0                  0
 -0.388886005       2.10E-04
 -0.777750015       5.10E-04
 -0.972150028       6.90E-04
 -1.166540027       8.80E-04
 -1.555330038       1.30E-03
 -1.944100022       1.78E-03
 -0.971710026       5.80E-04
 4.00E-05           3.00E-05
 ----------------------------
 0                  0
 -4.40E-04          0.271560013
 -1.30E-03          0.543290019
 -2.40E-03          0.815069973
 -3.82E-03          1.086820006
 -5.28E-03          1.358809948
 -2.57E-03          0.815530002
 1.50E-04           1.00E-05
 0                  0
 1.44E-03           -0.271450013
 3.06E-03           -0.543120027
 4.46E-03           -0.814930022
 5.67E-03           -1.086799979
 6.88E-03           -1.35879004
 4.51E-03           -0.815479994
 -2.00E-05          0</pre> The code to compute the crosstalk errors given the above raw data is then as follows. <div class="fragment"><div class="line"><span class="keyword">program</span> main</div><div class="line">  <span class="comment">! Parameters</span></div><div class="line">  <span class="keywordtype">integer(int32)</span>, <span class="keywordtype">parameter</span> :: npts = 34</div><div class="line">  <span class="keywordtype">integer(int32)</span>, <span class="keywordtype">parameter</span> :: ndof = 2</div><div class="line"></div><div class="line">  <span class="comment">! Local Variables</span></div><div class="line">  <span class="keywordtype">integer(int32)</span> :: indices(2*ndof)</div><div class="line">  <span class="keywordtype">real(real64)</span>, <span class="keywordtype">dimension(npts, ndof)</span> :: xin, xout, xerr, xmeas</div><div class="line">  <span class="keywordtype">real(real64)</span>, <span class="keywordtype">dimension(ndof, npts)</span> :: xint, xmeast</div><div class="line">  <span class="keywordtype">real(real64)</span>, <span class="keywordtype">dimension(ndof, ndof)</span> :: c, ans, xt</div><div class="line"></div><div class="line">  <span class="comment">! Initialization</span></div><div class="line">  xin = reshape([0.0, 3000.0, 6000.0, 7500.0, 9000.0, 12000.0, &amp;</div><div class="line">      15000.0, 7500.0, 0.0, 0.0, -3000.0, -6000.0, -7500.0, -9000.0, &amp;</div><div class="line">      -12000.0, -15000.0, -7500.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, &amp;</div><div class="line">      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, &amp;</div><div class="line">      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, &amp;</div><div class="line">      0.0, 0.0, 0.0, 67.7908728, 135.5817456, 203.3726184, 271.1634912, &amp;</div><div class="line">      338.954364, 203.3726184, 0.0, 0.0, -67.7908728, -135.5817456, &amp;</div><div class="line">      -203.3726184, -271.1634912, -338.954364, -203.3726184, 0.0], &amp;</div><div class="line">      [npts, ndof])</div><div class="line">  xout = reshape([0.0, 0.38905, 0.77816, 0.97269, 1.16714, 1.556, &amp;</div><div class="line">      1.94484, 0.9726, -1.0e-5, 0.0, -0.388886, -0.77775, -0.97215, &amp;</div><div class="line">      -1.16654, -1.55533, -1.9441, -0.97171, 4.0e-5, 0.0, -0.00044, &amp;</div><div class="line">      -0.0013, -0.0024, -0.00382, -0.00528, -0.00257, 0.00015, 0.0, &amp;</div><div class="line">      0.00144, 0.00306, 0.00446, 0.00567, 0.00688, 0.00451, -2.0e-5, &amp;</div><div class="line">      0.0, 0.00122, 0.00259, 0.0029, 0.00314, 0.00338, 0.00356, 0.00477,&amp;</div><div class="line">      -1.0e-5, 0.0, 0.00021, 0.00051, 0.00069, 0.00088, 0.0013, 0.00178,&amp;</div><div class="line">      0.00058, 3.0e-5, 0.0, 0.27156, 0.54329, 0.81507, 1.08682, 1.35881,&amp;</div><div class="line">      0.81553, 1.0e-5, 0.0, -0.27145, -0.54312, -0.81493, -1.0868, &amp;</div><div class="line">      -1.35879, -0.81548, 0.0], [npts, ndof])</div><div class="line"></div><div class="line">  <span class="comment">! Compute the calibration gains</span></div><div class="line">  xint = transpose(xin)</div><div class="line">  xmeast = transpose(xout)</div><div class="line">  c = linear_least_squares(xmeast, xint)</div><div class="line">  xmeas = matmul(xout, transpose(c))</div><div class="line">  xerr = xmeas - xin</div><div class="line"></div><div class="line">  <span class="comment">! The indices are</span></div><div class="line">  indices = [1, 17, 18, 34]</div><div class="line"></div><div class="line">  <span class="comment">! Compute the crosstalk matrix</span></div><div class="line">  xt = crosstalk(xerr, indices)</div><div class="line"><span class="keyword">end program</span></div></div><!-- fragment --> The least squares fit generates the following matrix of calibration gains. <pre class="fragment"> 7713.710427        33.5206917
 -0.214743728       249.4768498</pre> The resulting measured values are then as follows. <pre class="fragment"> 0                  0
 3001.05999         0.220815702
 6002.58754         0.479040049
 7503.146099        0.514603781
 9003.085297        0.532721294
 12002.64668        0.509090486
 15002.05157        0.470495427
 7502.514526        0.981144827
 -0.077472309       -0.002492621
 0                  0
 -2999.74699        0.135900968
 -5999.321307       0.294250127
 -7498.860677       0.380902151
 -8998.322469       0.470046784
 -11997.32196       0.658317276
 -14996.16495       0.861552092
 -7495.47032        0.353365205
 0.30955403         7.48E-03
 ----------------------------
 0                  0
 5.708846869        67.74803112
 8.183633648        135.5385616
 8.808803389        203.3416047
 6.96458466         271.1372518
 4.81985707         338.9927591
 7.512893885        203.4564077
 1.157391826        2.46E-03
 0                  0
 2.008550989        -67.72080332
 5.398195074        -135.4965304
 7.086130239        -203.3071324
 7.306450061        -271.1326527
 7.522743936        -338.9881361
 7.453379661        -203.4443484
 -0.154274205       4.29E-06</pre> The crosstalk error matrix is then as follows. <pre class="fragment"> 0                  0.981144827
 8.808803389        0</pre> </dd></dl>

<p>Definition at line <a class="el" href="curvefit__calibration_8f90_source.html#l00942">942</a> of file <a class="el" href="curvefit__calibration_8f90_source.html">curvefit_calibration.f90</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacecurvefit__calibration.html">curvefit_calibration</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
